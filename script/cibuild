#!/bin/sh

# Выход в случае ошибки
set -e

cd "$(dirname "$0")/.."

echo "==> Installing front-end dependencies..."
echo "==> yarn..."
# --ignore-platform для freebsd, так как пакет default-gateway выдает ошибку
yarn --ignore-platform

echo "==> yarn run production..."
yarn run production

# Архив для быстрого деплоя
tar --exclude ^deploy.tar \
  --exclude ^.git \
  --exclude ^node_modules \
  --exclude ^resources/css \
  --exclude ^resources/js \
  --exclude ^resources/sass \
  --exclude ^tests \
  --exclude ^vendor \
  -cf deploy.tar .
